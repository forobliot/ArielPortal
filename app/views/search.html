<h3>Offerta didattica siti</h3>
<div class="panel panel-default" ng-show="isSearchForm">
	  <div class="panel-heading">
			<h3 class="panel-title">Ricerca avanzata</h3>
	  </div>
	  <div class="panel-body">
		<form role="form">
			<div class="form-group">
				<label for="faculty">Facoltà</label>
				<select id="faculty" class="form-control" ng-options="key as faculty.Description for (key, faculty) in faculties" ng-change="fillCdses()" ng-model="searchContext.FacultyKey">
					<option value="">-- selziona una facoltà --</option>
					
				</select>
				<div ng-show="cdses.length">
				<label for="cds">Corsi di Studio</label>
				<select id="cds" class="form-control" ng-options="cds.Key as cds.PrettyName for cds in cdses" ng-model="searchContext.CdsKey">
					<option value="">-- Tutti i corsi di studio --</option>
				</select>
				</div>
			</div>
			<div class="form-group">
				<label for="keyword">Parola chiave</label>
				<input type="text" id="keyword" class="form-control" ng-model="searchContext.Keyword">
			</div>
			<div class="form-group">
				<label for="teacher">Nome docente</label>
				<input type="text" id="teacher" class="form-control" ng-model="searchContext.Teacher">
			</div>
			<div class="form-group" ng-show="user">
				<label>Filtri</label>
				<div class="checkbox" ng-show="user.IsBaseStudent">
					<label>
						<input type="checkbox" ng-model="searchContext.SearchFlags.IsCDSRuleComplying">
						CdS compatibili
					</label>
				</div>
				<div class="checkbox" ng-show="user.IsBaseStudent">
					<label>
						<input type="checkbox" ng-model="searchContext.SearchFlags.IsW4Visible">
						W4 compatibili
					</label>
				</div>
				<div class="checkbox">
					<label>
						<input type="checkbox" ng-model="searchContext.SearchFlags.IsEnrolled">
						Visitati
					</label>
				</div>
				<div class="checkbox">
					<label>
						<input type="checkbox" ng-model="searchContext.SearchFlags.IsFavorite">
						Preferiti
					</label>
				</div>
				<div class="checkbox" ng-show="user.IsBaseStudent">
					<label>
						<input type="checkbox" ng-model="searchContext.SearchFlags.IsInfaculty">
						Della facoltà
					</label>
				</div>
				<div class="checkbox" ng-show="user.IsOwner">
					<label>
						<input type="checkbox" ng-model="searchContext.SearchFlags.IsOwner">
						Titolare
					</label>
				</div>
				<div class="checkbox">
					<label>
						<input type="checkbox" ng-model="searchContext.SearchFlags.IsRuleComplying">
						Accessibili
					</label>
				</div>
			</div>
			<div class="form-group">
				<button class="btn btn-default" ng-click="search()">Cerca</button>
				<button class="btn btn-default" ng-click="reset()">Reset</button>
			</div>
		</form>
	  </div>
</div>
<div class="panel panel-info">
	<div class="panel-body bg-info">
		<p ng-bind-html="searchVerbose" ng-show="searchVerbose"></p>
		<p ng-bind-html="searchFilterVerbose" ng-show="searchFilterVerbose"></p>
		<p><kbd>Numero siti</kbd> <strong>{{ projectList.ProjectCount }}</strong></p>
		<p class="text-right" ng-hide="isSearchForm"><a href='' ng-click="isSearchForm = true">Apri ricerca avanzata</a></p>
		<p class="text-right" ng-show="isSearchForm"><a href='' ng-click="isSearchForm = false">Chiudi ricerca avanzata</a></p>
	</div>
</div>
<p ng-show="searchContext.SelectedFacultyKey != null"><a href="" ng-click="search()">Torna all'elenco delle facoltà</a></p>

<div ng-repeat="header in result.SearchHeaderList">
	
	<!-- intestazione di facoltà -->
	<div ng-if="header.Faculty">
		<h3><small><span class="arl-dot glyphicon glyphicon-asterisk" ng-class="'arl-faculty-' + header.Faculty.Key"></span></small> <a href="" ng-click="search(header.Faculty.Key)">{{ header.Faculty.Description }}</a> <small>({{ header.Faculty.ProjectCount }} siti)</small></h3>
	</div>

	<!-- intestazione testuale -->
	<div ng-if="!header.Faculty">
		<h3>{{ header.Title }}</h3>
		<p ng-show="header.Note">{{ header.Note }}</p>
	</div>

	<ul class="list-group" ng-show="header.ProjectList">
		<li  class="list-group-item" ng-repeat="pw in header.ProjectList">

			<h4><span ng-show="pw.Project.IsPoolMaster" class="glyphicon glyphicon-fullscreen text-danger"></span> <span ng-bind-html="pw.Project.Name" /></h4>

			<div>
				<small>
					<strong>
						{{pw.Project.ProjectTypeString == "Default" || pw.Project.ProjectTypeString == "Other" ? 'Docent' : 'Coordinator'}}{{pw.Project.OwnerList.length == 1 ? "e" : "i"}}:
					</strong>
					<ul class="arl-teacher-list">
						<li ng-repeat="teacher in pw.Project.OwnerList">{{ teacher.FirstName }} {{ teacher.LastName }}</li>
					</ul>
				</small>
			</div>

			<div ng-hide="pw.Project.IsPublic"><small class="text-danger bg-danger"><strong>Sito non pubblico</strong></small></div>
			<div ng-hide="pw.IsRuleComplying"><small class="text-danger bg-danger"><strong>Sito non accessibile</strong></small></div>
			<div ng-show="pw.LastAccessDate"><small>Ultima visita: {{ project.LastAccessDate | date : 'd/MM/yyyy HH:mm' }}</small> </div>
			<ul ng-show="isdebug">
				<li ng-repeat="attr in projectAttrs">
					{{ projectAttrs[$index] }}: <span ng-class="pw[attr] ? 'bg-success' : 'bg-danger'">{{ project[attr] }}</span>
				</li>
			</ul>
			<div class="text-right">
				<button 
					ng-show="user && pw.IsRuleComplying" 
					type="button" 
					class="btn btn-xs" 
					ng-class="pw.IsFavorite ? 'btn-danger' : 'btn-default'"
					ng-click="toggleFavorite($index)"
					ng-bind-html="pw.IsFavorite ? '<span class=\'glyphicon glyphicon-asterisk\'></span> Rimuovi dai preferiti' : '<span class=\'glyphicon glyphicon-plus-sign\'></span> Aggiungi ai preferiti'">
				</button> 
				<button ng-show="pw.Project.IsPoolMaster" type="button" class="btn btn-primary btn-xs" ng-click="getPool(pw)">Siti correlati</button>
				<button ng-click="getProject(pw)" type="button" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-info-sign"></span> <span ng-show="pw.Project.Id == projectCardId">Chiudi</span> Info</button>
			</div>

			<div class="arl-siteinfo" ng-if="pw.Project.Id == projectCardId" ng-include="'views/card.html'"></div>
		</li>
	</ul>
</div>

<p ng-show="result.ProjectCount == 0">
	<em>Nessun sito trovato</em>
</p>

<p ng-show="projectList.ProjectList.length > showCount"><a href="" ng-click="showMore()">Visualizza altri siti... (mancano all'elenco {{ projectList.ProjectList.length - showCount }} siti)</a></p>
